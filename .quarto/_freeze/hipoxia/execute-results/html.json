{
  "hash": "42019506a00d0e5a0e062cecb2c1fddc",
  "result": {
    "markdown": "---\ntitle: \"hipoxia\"\nsubtitle: \"Análise Introdutória de Dados\"\nauthor: \"Júlia Martinho\"\ndate: today\ndate-format: long\nformat:\n  html:\n    smooth-scroll: true\n    self-contained: true\n    toc: true\n    toc-location: left\ntheme: cosmo\nsmooth-scroll: true\nexecute:\n  warning: false\nproject:\n  output-dir: outputs/documents\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"tidyverse\", repos = \"http://cran.us.r-project.org\")\n## package 'tidyverse' successfully unpacked and MD5 sums checked\n## \n## The downloaded binary packages are in\n## \tC:\\Users\\user\\AppData\\Local\\Temp\\RtmpoTjCJ8\\downloaded_packages\ninstall.packages(\"readxl\", repos = \"http://cran.us.r-project.org\")\n## package 'readxl' successfully unpacked and MD5 sums checked\n## \n## The downloaded binary packages are in\n## \tC:\\Users\\user\\AppData\\Local\\Temp\\RtmpoTjCJ8\\downloaded_packages\ninstall.packages(\"lubridate\", repos = \"http://cran.us.r-project.org\")\n## package 'lubridate' successfully unpacked and MD5 sums checked\n## \n## The downloaded binary packages are in\n## \tC:\\Users\\user\\AppData\\Local\\Temp\\RtmpoTjCJ8\\downloaded_packages\n\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(lubridate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia <- read_excel(\"datasets/hypoxia.xlsx\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"janitor\")\n## Installing janitor [2.1.0] ...\n## \tOK [linked cache]\nhipoxia <- janitor::clean_names(hipoxia)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia <- hipoxia %>% mutate(type_surg=recode(type_surg,\n                         '1' = \"gastroenterostomy\", '2'=\"gastric restrictive procedure\", '3'=\"gastroplasty\", '4'=\"removal of gastric restrictive \ndevice\"\n                         ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia_sum <- hipoxia %>%  group_by(type_surg) %>%\n  summarise(prop_female=mean(female, na.rm = TRUE),\n            prop_smoking=mean(smoking,na.rm=TRUE),\n            prop_diabetes=mean(diabetes,na.rm=TRUE),\n            prop_hyper=mean(hyper, na.rm=TRUE),\n            prop_cad=mean(cad, na.rm=TRUE),\n            prop_preop_med=mean(preop_anti_hyper_med, na.rm=TRUE),\n            prop_cpap=mean(cpap, na.rm=TRUE),\n            mean_age=mean(age,na.rm=TRUE),\n            mean_bmi=mean(bmi,na.rm=TRUE),\n            mean_sleeptime=mean(sleeptime,na.rm=TRUE),\n            mean_surg_dur=mean(duration_of_surg, na.rm=TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#hipoxia_sum_all <- hipoxia %>% group_by(type_surg) %>%\n  #summarise(cases=n())\n```\n:::\n\n\n#Variáveis em Análise\n\n::: {.cell}\n\n```{.r .cell-code}\n#lista\n```\n:::\n\n\n##Nota\n\nCálculo do Índice de Apneia-Hipoapneia\n\n::: {.cell}\n\n```{.r .cell-code}\n#equação\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#tabela 1: freq absoluta, relativa e médias\nhipoxia_sum_wide <- hipoxia %>% \n  select(type_surg,female,race,smoking,diabetes,hyper,cad,preop_anti_hyper_med,cpap,sleeptime) %>% \n  group_by(type_surg) %>%\n  summarise(all_cases=n(),\n            freq_female=sum(female), freq_male=sum(!female),\n            #freq_white=sum(race=2), freq_black=sum(race=1), freq_other=sum(race=3),\n            freq_smoking=sum(smoking),\n            freq_diabetes=sum(diabetes),\n            freq_hyper=sum(hyper),\n            freq_cad=sum(cad),\n            freq_preop_med=sum(preop_anti_hyper_med),\n            freq_cpap=sum(cpap),\n            mean_sleeptime=mean(sleeptime,na.rm=TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"kableExtra\")\n## Installing kableExtra [1.3.4] ...\n## \tOK [linked cache]\nlibrary(kableExtra)\n\ntable1<- hipoxia_sum_wide %>%\n  kbl(digits = 2,\n      caption = \"Medidas de Frequência Absoluta\") %>%\n  kable_classic(full_width = F, \n                html_font = \"Calibri\")\n\ntable1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Medidas de Frequência Absoluta</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> type_surg </th>\n   <th style=\"text-align:right;\"> all_cases </th>\n   <th style=\"text-align:right;\"> freq_female </th>\n   <th style=\"text-align:right;\"> freq_male </th>\n   <th style=\"text-align:right;\"> freq_smoking </th>\n   <th style=\"text-align:right;\"> freq_diabetes </th>\n   <th style=\"text-align:right;\"> freq_hyper </th>\n   <th style=\"text-align:right;\"> freq_cad </th>\n   <th style=\"text-align:right;\"> freq_preop_med </th>\n   <th style=\"text-align:right;\"> freq_cpap </th>\n   <th style=\"text-align:right;\"> mean_sleeptime </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 20.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 165 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 120 </td>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 145 </td>\n   <td style=\"text-align:right;\"> 18.66 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gastroplasty </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> removal of gastric restrictive \ndevice </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8.95 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable2<- hipoxia_sum %>%\n  select(type_surg,prop_female,prop_smoking, prop_diabetes, prop_hyper, prop_cad) %>%\n  kbl(digits = 2,\n      caption = \"Medidas de Frequência Relativa\") %>%\n  kable_classic(full_width = F, \n                html_font = \"Calibri\") \n\ntable2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Medidas de Frequência Relativa</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> type_surg </th>\n   <th style=\"text-align:right;\"> prop_female </th>\n   <th style=\"text-align:right;\"> prop_smoking </th>\n   <th style=\"text-align:right;\"> prop_diabetes </th>\n   <th style=\"text-align:right;\"> prop_hyper </th>\n   <th style=\"text-align:right;\"> prop_cad </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> gastric restrictive procedure </td>\n   <td style=\"text-align:right;\"> 0.63 </td>\n   <td style=\"text-align:right;\"> 0.41 </td>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 0.53 </td>\n   <td style=\"text-align:right;\"> 0.36 </td>\n   <td style=\"text-align:right;\"> 0.71 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> gastroplasty </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> removal of gastric restrictive \ndevice </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.50 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n#Box Plot: Idade e Tipo de Cirurgia\n\n::: {.cell}\n\n```{.r .cell-code}\nhipoxia <- hipoxia %>% mutate(female_cat=recode(female,\n                         '1' = \"female\", '0'=\"male\"))\n\nage1<- ggplot(data= hipoxia, \n            aes(x =female_cat, y = age)) +\n  geom_boxplot(outlier.shape = NA) +\n  facet_wrap(~type_surg) + \n  labs(title = \"Idade dos Doentes por Tipo de Cirurgia e Sexo\",\n         y = \"Idade\",\n         x = \"Tipo de Cirurgia\")\nage1\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#BMI por Tipo de Cirurgia\n\n::: {.cell}\n\n```{.r .cell-code}\n\nbmi1<- ggplot(data= hipoxia, \n            aes(x = type_surg, y = bmi)) +\n  geom_boxplot(outlier.shape = NA, \n               fill = \"pink\", \n               colour = \"black\") +\n  ylim(30,70) + \n  labs(title = \"Índice de Massa Corporal por Tipo de Cirurgia\",\n         y = \"Índice de Massa Corporal\",\n         x = \"Tipo de Cirurgia\") + \n        scale_x_discrete(labels=c(\"gastric restrictive procedure\" = \"Gastric Restrictive Procedure\", \"gastroenterostomy\" = \"Gastroenterostomy\", \"gastroplasty\" = \"Gastroplasty\", \"removal of gastric restrictive  device\" = \"Removal of Gastric Restrictive Device\")) +\n  theme_minimal()\nbmi1\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n#Scatter Plot\n\n::: {.cell}\n\n```{.r .cell-code}\n#gráfico dispersão\ninstall.packages(\"ggthemes\")\n## Installing ggthemes [4.2.4] ...\n## \tOK [linked cache]\nlibrary(ggthemes)\n\nscatter1 <- ggplot(data = hipoxia, \n       aes(x=duration_of_surg, y=mac)) + \n  geom_point(alpha=0.5) +\n  labs(title = \"Duração da Cirurgia e Quantidade de Gás Anestésico\",\n         y = \"Gás Anestésico (horas MAC)\",\n         x = \"Duração da Cirurgia (h)\") +\n  theme_clean()\n\nscatter1\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n#Gráfico de Barras\n\n::: {.cell}\n\n```{.r .cell-code}\n#tipo de cirurgia + indice apneia com y=map\nbar1<-  ggplot( data = hipoxia_sum_wide,\n            aes(x = type_surg, \n                y = freq_hyper)\n            ) +\n  geom_bar(position=\"dodge\", \n           stat=\"identity\"\n           ) +\n  \n    scale_fill_manual(values=c(\"#fee0d2\",\"#fc9272\")) +\n  \n  labs(title = \"Número de Hipertensos por Tipo de Cirurgia\",\n         y = \"Número de Hipertensos\",\n         x = \"Tipo de Cirurgia\") +\n  theme_minimal() +\n  theme(legend.position=\"bottom\")\n\nbar1\n```\n\n::: {.cell-output-display}\n![](hipoxia_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n#Modelo de Regressão\n\n::: {.cell}\n\n```{.r .cell-code}\n#7. Devem utilizar um modelo de regressao para avaliar se ha diferencas entre o valor de BMI por tipo de cirurgia ajustado pra sexo e idade \n#\tOutcome: BMI\n#\tVariável explicativa: BMI\n#\tAjustar: Sexo e Idade\n\nmodel1 <- lm(bmi ~ \n               as.factor(type_surg)+\n               as.factor(female)+\n               age, \n             data= hipoxia)\n\ninstall.packages(\"broom\")\n## Installing broom [1.0.1] ...\n## \tOK [linked cache]\nlibrary(broom)\nmodel1_tidy <- tidy(model1, conf.int = TRUE)\n\ntable_model1<- model1_tidy %>%\n  kbl(digits = 3,\n      caption = \"\") %>%\n  kable_classic(full_width = F, \n                html_font = \"Calibri\")\n\ntable_model1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Calibri; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption></caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 52.420 </td>\n   <td style=\"text-align:right;\"> 2.450 </td>\n   <td style=\"text-align:right;\"> 21.398 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 47.597 </td>\n   <td style=\"text-align:right;\"> 57.242 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> as.factor(type_surg)gastroenterostomy </td>\n   <td style=\"text-align:right;\"> 3.286 </td>\n   <td style=\"text-align:right;\"> 1.175 </td>\n   <td style=\"text-align:right;\"> 2.798 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.974 </td>\n   <td style=\"text-align:right;\"> 5.598 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> as.factor(type_surg)gastroplasty </td>\n   <td style=\"text-align:right;\"> 1.869 </td>\n   <td style=\"text-align:right;\"> 4.515 </td>\n   <td style=\"text-align:right;\"> 0.414 </td>\n   <td style=\"text-align:right;\"> 0.679 </td>\n   <td style=\"text-align:right;\"> -7.019 </td>\n   <td style=\"text-align:right;\"> 10.757 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> as.factor(type_surg)removal of gastric restrictive \ndevice </td>\n   <td style=\"text-align:right;\"> 4.624 </td>\n   <td style=\"text-align:right;\"> 5.429 </td>\n   <td style=\"text-align:right;\"> 0.852 </td>\n   <td style=\"text-align:right;\"> 0.395 </td>\n   <td style=\"text-align:right;\"> -6.063 </td>\n   <td style=\"text-align:right;\"> 15.312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> as.factor(female)1 </td>\n   <td style=\"text-align:right;\"> -1.315 </td>\n   <td style=\"text-align:right;\"> 1.005 </td>\n   <td style=\"text-align:right;\"> -1.309 </td>\n   <td style=\"text-align:right;\"> 0.192 </td>\n   <td style=\"text-align:right;\"> -3.293 </td>\n   <td style=\"text-align:right;\"> 0.663 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:right;\"> -0.157 </td>\n   <td style=\"text-align:right;\"> 0.041 </td>\n   <td style=\"text-align:right;\"> -3.802 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -0.238 </td>\n   <td style=\"text-align:right;\"> -0.076 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [
      "hipoxia_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"hipoxia_files/libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"hipoxia_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}